@import 'tailwindcss';

/* Tailwind v4 theme tokens for terminal-style palette */
@theme {
  --color-term-bg: #0b0f14;
  --color-term-fg: #e6edf3;
  --color-term-dim: #8b949e;
  --color-term-accent: #2f81f7;
  --color-term-border: #1f2630;
  --color-term-ok: #4ade80;
  --color-term-err: #f87171;
}

/* Dark theme overrides for terminal tokens (outside @theme per Tailwind v4 rules) */
[data-theme='dark'] {
  --color-term-bg: #0b0f14;
  --color-term-fg: #e6edf3;
  --color-term-dim: #8b949e;
  --color-term-accent: #2f81f7;
  --color-term-border: #1f2630;
  --color-term-ok: #4ade80;
  --color-term-err: #f87171;
}

/* Tailwind component shortcuts using @apply */
@layer components {
  /* --------------------------------------------------
     Consolidated component layer (deduplicated)
     -------------------------------------------------- */

  /* Terminal card */
  .terminal-card {
    @apply w-full max-w-[720px] overflow-hidden rounded-lg border border-term-border bg-term-bg text-term-fg shadow-xl;
  }

  /* Prompt rows */
  .prompt-row {
    @apply mb-2 flex items-center gap-2;
  }
  .prompt-chevron {
    @apply w-4 text-center text-term-accent;
  }
  .prompt-label {
    @apply w-24 shrink-0 text-[12px] text-term-dim;
  }
  .muted {
    @apply text-[12px] text-term-dim;
  }

  /* Inputs */
  .input-term {
    @apply flex-1 rounded border border-slate-700/70 bg-transparent px-2 py-1 text-[13px] outline-none transition focus:border-term-accent focus:ring-1 focus:ring-term-accent disabled:cursor-not-allowed disabled:opacity-60;
  }
  .select-term {
    @apply flex-1 rounded border border-slate-700/70 bg-transparent px-2 py-1 text-[13px] outline-none transition focus:border-term-accent focus:ring-1 focus:ring-term-accent disabled:cursor-not-allowed disabled:opacity-60 appearance-none pr-6;
  }
  .textarea-term {
    @apply flex-1 rounded border border-slate-700/70 bg-transparent px-2 py-1 text-[13px] outline-none transition focus:border-term-accent focus:ring-1 focus:ring-term-accent disabled:cursor-not-allowed disabled:opacity-60 min-h-[90px];
  }
  .form-hint {
    @apply mt-1 text-[11px] text-term-dim;
  }
  .field-row {
    @apply grid grid-cols-[10rem_1fr] items-start gap-3;
  }
  .input-invalid {
    @apply border-red-500/60 focus:border-red-500 focus:ring-1 focus:ring-red-500;
  }
  .field-error {
    @apply mt-1 text-[11px] text-red-400;
  }
  .input-term-sm {
    @apply px-1.5 py-0.5 text-[12px];
  }
  .input-term-lg {
    @apply px-3 py-2 text-[14px];
  }

  /* Buttons (base + states) */
  .btn {
    @apply inline-flex items-center gap-1 rounded border px-2 py-1 text-[12px] font-medium tracking-[0.5px] transition cursor-pointer disabled:cursor-not-allowed disabled:opacity-50 text-[var(--btn-fg)] border-[var(--btn-border)] shadow-[0_1px_2px_rgba(0,0,0,0.4),inset_0_0_0_1px_rgba(255,255,255,0.05)];
  }
  .btn:hover:not(:disabled) {
    @apply opacity-95;
  }
  .btn:active:not(:disabled) {
    @apply translate-y-px;
  }
  .btn:focus-visible {
    @apply outline-none ring-2 ring-[var(--accent-color)] ring-offset-2 ring-offset-transparent;
  }
  .btn-sm {
    @apply px-1.5 py-0.5 text-[11px];
  }
  .btn-lg {
    @apply px-3 py-1.5 text-[13px];
  }
  .btn-group {
    @apply inline-flex items-center gap-2;
  }

  /* Button variants (only color differences) */
  .btn-primary {
    @apply border-term-accent/40 bg-term-accent/20 text-term-accent hover:border-term-accent hover:bg-term-accent/30 lowercase;
  }
  .btn-secondary {
    @apply border-slate-600/60 text-slate-200 hover:bg-slate-600/20 lowercase;
  }
  .btn-danger {
    @apply border-red-500/40 bg-red-500/10 text-red-300 hover:border-red-500 hover:bg-red-500/20 lowercase;
  }
  .btn-success {
    @apply border-emerald-500/40 bg-emerald-500/10 text-emerald-300 hover:border-emerald-500 hover:bg-emerald-500/20 lowercase;
  }

  /* Light theme contrast overrides */
  [data-theme='light'] .btn-secondary {
    @apply text-slate-800 border-slate-400/80 hover:bg-slate-400/10;
  }
  [data-theme='light'] .btn-danger {
    @apply text-red-700 border-red-500/50 bg-red-500/10 hover:bg-red-500/20;
  }
  [data-theme='light'] .btn-success {
    @apply text-emerald-700 border-emerald-500/50 bg-emerald-500/10 hover:bg-emerald-500/20;
  }
  [data-theme='light'] .btn-primary {
    @apply text-[var(--accent-color)];
  }

  /* Icon button (doesn't rely on @extend) */
  .icon-btn {
    @apply inline-flex items-center justify-center rounded border px-1.5 py-1 text-[12px] font-medium tracking-[0.5px] transition cursor-pointer disabled:cursor-not-allowed disabled:opacity-50 text-current border-[var(--border-color)] shadow-[0_1px_2px_rgba(0,0,0,0.4),inset_0_0_0_1px_rgba(255,255,255,0.05)];
  }
  .icon-btn:hover:not(:disabled) {
    @apply opacity-90;
  }
  .icon-btn:focus-visible {
    @apply outline-none ring-2 ring-[var(--accent-color)] ring-offset-2;
  }

  /* Panels */
  .panel-card {
    @apply rounded-md border shadow-sm;
    background: var(--panel-bg);
    border-color: var(--border-color);
    color: inherit;
  }
  .panel-header-row {
    @apply flex items-center justify-between px-2 py-1 text-[11px] uppercase tracking-wide;
    background: var(--panel-header-bg);
    border-bottom: 1px solid var(--border-color);
    color: var(--color-text-dim);
  }
  .section-divider {
    @apply my-2 h-px w-full border-0;
    background: var(--panel-border-inner);
  }

  /* Toolbars */
  .toolbar-row {
    @apply flex items-center justify-between gap-2 border-b border-slate-700/60 bg-[var(--panel-header-bg)] px-2 py-1 text-[12px] text-[var(--color-text-dim)];
  }
  .toolbar-section {
    @apply inline-flex items-center gap-4;
  }
  .toolbar-spacer {
    @apply grow;
  }

  /* Menus */
  .menu-anchor {
    @apply relative;
  }
  .menu-dropdown {
    @apply absolute right-0 top-[110%] z-50 min-w-[140px] rounded border py-1 text-[13px] shadow-lg;
    background: var(--panel-bg);
    border-color: var(--border-color);
    color: var(--color-text);
  }
  .menu-item {
    @apply cursor-pointer whitespace-nowrap px-2.5 py-1.5;
  }
  .menu-item:hover {
    @apply bg-white/5;
  }
  .menu-empty {
    @apply px-2.5 py-1.5 text-[12px] text-term-dim;
  }

  /* Skeletons */
  .skeleton {
    @apply animate-pulse rounded bg-slate-500/20;
  }
  .skeleton-line {
    @apply animate-pulse rounded bg-slate-500/20 h-3;
  }

  /* Lists */
  .list-row {
    @apply flex items-center justify-between gap-3 border-b border-slate-800/60 px-2 py-1.5 text-[13px];
  }
  .list-row-hover {
    @apply hover:bg-white/5;
  }

  /* Helpers */
  .code-inline {
    @apply rounded border px-1.5 py-0.5 text-[12px] font-mono;
    background: color-mix(in srgb, var(--panel-header-bg) 70%, transparent);
    border-color: var(--border-color);
  }
  .shadow-term {
    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.45);
  }

  /* Notices */
  .notice {
    @apply mt-3 text-[12px];
  }
  .notice-ok {
    @apply mt-3 text-[12px] text-term-ok;
  }
  .notice-err {
    @apply mt-3 text-[12px] text-term-err;
  }

  /* Badges / chips */
  .badge,
  .chip {
    @apply inline-flex items-center gap-1 rounded border px-1.5 py-0.5 text-[11px];
    background: var(--panel-header-bg);
    border-color: var(--border-color);
    color: var(--color-text-dim);
  }

  /* Status pills */
  .pill {
    @apply inline-flex items-center rounded-full px-2 py-0.5 text-[11px] font-medium;
  }
  .pill-ok {
    @apply inline-flex items-center rounded-full px-2 py-0.5 text-[11px] font-medium bg-term-ok/10 text-term-ok ring-1 ring-inset ring-term-ok/30;
  }
  .pill-err {
    @apply inline-flex items-center rounded-full px-2 py-0.5 text-[11px] font-medium bg-term-err/10 text-term-err ring-1 ring-inset ring-term-err/30;
  }
  .pill-warn {
    @apply inline-flex items-center rounded-full px-2 py-0.5 text-[11px] font-medium bg-yellow-500/10 text-yellow-300 ring-1 ring-inset ring-yellow-500/30;
  }
  .pill-info {
    @apply inline-flex items-center rounded-full px-2 py-0.5 text-[11px] font-medium bg-term-accent/10 text-term-accent ring-1 ring-inset ring-term-accent/30;
  }

  /* Links */
  a.link-term {
    @apply text-term-accent underline underline-offset-2 hover:opacity-90;
  }

  /* Tables */
  .table-tiny {
    @apply w-full text-[12px];
  }
  .table-tiny thead th {
    @apply py-1 text-left font-medium text-term-dim border-b border-slate-700/70;
  }
  .table-tiny tbody td {
    @apply py-1 align-top border-b border-slate-800/70;
  }
  .table-compact tbody tr:hover {
    @apply bg-white/5;
  }

  /* Scroll area */
  .scroll-area {
    @apply overflow-auto;
  }
}

/* existing imports if any */
/* Base (light) theme */
:root {
  --color-bg: #f5f7fa;
  --color-bg-alt: #ffffff;
  --panel-bg: #ffffff;
  --panel-header-bg: #eef1f5;
  --panel-border-inner: #dfe3e8;
  --border-color: #cfd6dd;
  --color-text: #1f2328;
  --color-text-dim: #57606a;
  --accent-color: #0969da;
  --font-mono:
    'SFMono-Regular', ui-monospace, 'JetBrains Mono', 'Source Code Pro', Menlo, Consolas, monospace;
  --btn-bg-start: #ffffff;
  --btn-bg-end: #f1f4f8;
  --btn-border: #dfe3e8;
  --btn-fg: #1f2328;
  --color-bg-secondary: #f5f7fa;
  --color-text: #1f2328;
  --color-bg-tertiary: #eef1f5;
  --color-success: #2abf6e;
  --color-error: #d73a49;
  --color-warning: #ffa500;
  --color-info: #2f81f7;
  --color-border-strong: #cfd6dd;
  /* Scrollbar (light) */
  --scrollbar-track: transparent;
  --scrollbar-thumb: #c8d1da;
  --scrollbar-thumb-hover: #b6c0cb;
}
/* Dark theme override (activated via [data-theme='dark']) */
[data-theme='dark'] {
  --color-bg: #121417;
  --color-bg-alt: #1a1d21;
  --panel-bg: #16191d;
  --panel-header-bg: #20252b;
  --panel-border-inner: #232a31;
  --border-color: #2a3139;
  --color-text: #d0d7de;
  --color-text-dim: #8b949e;
  --accent-color: #2f81f7;
  --btn-bg-start: #3e3e3e;
  --btn-bg-end: #2a2a2a;
  --btn-border: #555;
  --btn-fg: #e8e8e8;
  --color-bg-secondary: #1a1d21;
  --color-text: #d0d7de;
  --color-bg-tertiary: #20252b;
  --color-success: #4ade80;
  --color-error: #f87171;
  --color-warning: #ffb86c;
  --color-info: #2f81f7;
  --color-border-strong: #343c45;
  /* Scrollbar (dark) */
  --scrollbar-track: transparent;
  --scrollbar-thumb: #2a3037;
  --scrollbar-thumb-hover: #343c45;
}

/* Ensure body inherits when dark attribute set at root */
[data-theme='dark'] body {
  background: var(--color-bg);
  color: var(--color-text);
}

/* Optional smooth swap */
body,
.dockview-wrapper {
  transition:
    background-color 0.25s ease,
    color 0.25s ease;
}

/* Dockview adjustments (base light) */
.dockview-theme-trad {
  --dv-activegroup-background: var(--panel-bg);
  --dv-group-view-background: var(--panel-bg);
  --dv-tabs-container-background: var(--panel-header-bg);
  --dv-paneview-header-background: var(--panel-header-bg);
  --dv-color: var(--color-text-dim);
  --dv-separator-color: var(--border-color);
  /* lighter shadow for light theme */
  --dv-floatingbox-shadow: 0 0 0 1px var(--border-color), 0 4px 16px rgba(0, 0, 0, 0.1);
}
/* Dark theme Dockview overrides */
[data-theme='dark'] .dockview-theme-trad {
  --dv-floatingbox-shadow: 0 0 0 1px var(--border-color), 0 4px 16px rgba(0, 0, 0, 0.4);
}
html,
body {
  margin: 0;
  padding: 0;
  /* Terminal-esque baseline: prefer monospace globally */
  font-family: var(
    --font-mono,
    'SFMono-Regular',
    ui-monospace,
    'JetBrains Mono',
    'Source Code Pro',
    Menlo,
    Consolas,
    monospace
  );
  line-height: 1.35;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  background: var(--color-bg);
  color: var(--color-text);
  /* Firefox themed scrollbar colors */
  scrollbar-color: var(--scrollbar-thumb) var(--scrollbar-track);
}

body,
#app {
  height: 100vh;
}

/* Scrollbars subtle */
::-webkit-scrollbar {
  width: 8px;
}

::-webkit-scrollbar-track {
  background: var(--scrollbar-track);
}

::-webkit-scrollbar-thumb {
  background: var(--scrollbar-thumb);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: var(--scrollbar-thumb-hover);
}

.panel {
  /* fallback if used outside scope */
  background: var(--panel-bg);
  border: 1px solid var(--border-color);
  border-radius: 4px;
}

.panel-header {
  background: var(--panel-header-bg);
  padding: 0 0.5rem;
}

/* (Removed original dark-as-default Dockview block; now overridden above for dark) */

.dockview-theme-trad .dv-tabs-and-actions-container {
  font-family: var(--font-mono);
  font-size: 11px;
}

.dockview-theme-trad .dv-tab,
.dockview-theme-trad .dv-default-tab {
  align-content: center;
  padding: 0px 4px;
}

.dockview-theme-trad .dv-tab.dockview-active {
  color: var(--color-text);
  background: #222a31;
  position: relative;
}

.dockview-theme-trad .dv-tab.dockview-active::after {
  content: '';
  position: absolute;
  left: 0;
  right: 0;
  bottom: 0;
  height: 2px;
  background: var(--accent-color);
}

.dockview-theme-trad .dv-paneview-header {
  text-transform: uppercase;
  letter-spacing: 0.05em;
  font-size: 11px;
}

/* Hover & focus states */
.dockview-theme-trad .dv-tab:hover:not(.dockview-active) {
  background: #1e252b;
  color: var(--color-text);
}

.dockview-theme-trad .dv-tab:focus-visible {
  outline: 2px solid var(--accent-color);
  outline-offset: -2px;
}

/* Drag overlay */
.dockview-theme-trad .dv-drop-target-overlay {
  box-shadow:
    0 0 0 1px var(--accent-color),
    0 0 0 3px rgba(47, 129, 247, 0.35);
  border-radius: 4px;
}

/* Resize handle emphasis */
.dockview-theme-trad .dv-sash {
  background: transparent;
}

.dockview-theme-trad .dv-sash:hover {
  background: #2a323a;
}

.dockview-theme-trad .dv-sash.active {
  background: var(--accent-color);
}

/* Dark theme */
[data-theme='dark'] .button {
  --btn-bg-start: #3e3e3e;
  --btn-bg-end: #2a2a2a;
  --btn-border: #555;
  --btn-fg: #e8e8e8;
}

/* --------------------------------------------------
   Terminal-style utilities (opt-in)
   -------------------------------------------------- */
.mono {
  font-family: var(
    --font-mono,
    'SFMono-Regular',
    ui-monospace,
    'JetBrains Mono',
    'Source Code Pro',
    Menlo,
    Consolas,
    monospace
  );
}

.dim {
  color: var(--color-text-dim);
}

.kbd {
  font-family: var(--font-mono);
  background: var(--panel-header-bg);
  border: 1px solid var(--border-color);
  border-bottom-color: var(--color-border-strong);
  padding: 0 4px;
  border-radius: 3px;
  font-size: 0.85em;
}

/* Prompt-style line (chevron, label, input) */
.prompt-line {
  display: grid;
  grid-template-columns: 1.25rem auto 1fr;
  align-items: center;
  gap: 0.5rem;
  padding: 0.35rem 0;
}
.prompt-line .chevron {
  color: var(--accent-color);
}
.prompt-line label {
  color: var(--color-text-dim);
  font-size: 13px;
}
.prompt-line input,
.prompt-line textarea {
  background: transparent;
  border: none;
  border-bottom: 1px dashed rgba(127, 127, 127, 0.25);
  padding: 4px 2px 3px 2px;
  color: inherit;
  caret-color: var(--accent-color);
  font-family: inherit;
  font-size: 13px;
}
.prompt-line input:focus,
.prompt-line textarea:focus {
  outline: none;
  border-bottom: 1px solid var(--accent-color);
}
.prompt-line input:disabled,
.prompt-line textarea:disabled {
  opacity: 0.6;
}

/* Selection color tuned to accent */
::selection {
  background: color-mix(in srgb, var(--accent-color) 30%, transparent);
}
